{
    "paper_id": "6502_disentangled_feature_swapping_",
    "title": "Disentangled Feature Swapping Augmentation for Weakly Supervised Semantic Segmentation",
    "abstract": "Weakly supervised semantic segmentation utilizes a localization map obtained from a classifier to generate a pseudo-mask. However, classifiers utilize background cues to predict class labels because of a biased dataset consisting of images, in which specific objects frequently co-occur with certain backgrounds. Consequently, the classifier confuses the background with the target objects, resulting in inaccurate localization maps. To this end, we propose DisEntangled FeaTure swapping augmentation(DEFT) to prevent the classifier from being biased by a misleading correlation. Our method first disentangles the foreground and background features. Then, we randomly swap the disentangled features within mini-batches via a two-way process. These features contain various contexts that do not appear in the biased dataset, but the class relevant representation is preserved. In addition, we introduce training schemes to obtain further performance gains. Experimental results showed that when our augmentation was used in various weakly supervised semantic segmentation methods trained on the Pascal VOC 2012 dataset, the performance of the localization maps and pseudo-mask as well as the segmentation results improved. ",
    "human_review": "Summary Of The Paper:\nThis paper studies the phenomenon that WSSS performance degrades with dataset biases where a specific target object frequently appears in the background. To resolve this issue, the paper proposes an augmentation method that disentangles target object and background-related features, so that the localization map focuses more on the real foreground. Experimental results show that the proposed module significantly improves mIoU scores across multiple existing approaches.\n\nStrength And Weaknesses:\nStrength:\n\n- The authors provide a detailed explanation of the unresolved data augmentation issue in current WSSS approaches (based on CAM).\n- The proposed idea is simple, reasonable, and consistently improves performance.\n- The two-way swapping idea is interesting and further improves results.\n\nWeaknesses:\n\n- The overall idea is quite similar to Lee et al. (2021d), albeit applied to a different task.\n- The motivation, framed as “biased data leading to degraded WSSS performance,” is not entirely convincing. In CAM, background attention occurs because classification uses contextual background features. Thus, the paper’s goal—preventing such leakage to get better foreground seeds—differs from Lee et al. (2021d), whose de-biasing aims to increase diversity and generalization. Therefore, describing this work as de-biasing might be misleading.\n- Several aspects of the presentation are unclear and need improvement.\n\nClarity, Quality, Novelty And Reproducibility:\n\nClarity & Quality:\n- Many terms and figures are unclear.\n- “Bias-aligned” is not defined. A clearer definition could be borrowed from Lee et al. (2021d).\n- Figure 1(b) remains confusing even with textual explanation.\n- It is unclear how AFA/ABA values are calculated or why they indicate correlation between regions.\n- The locations or representations of f_{fg} and f_{bg} in Figure 2 are not clear.\n\nNovelty:\n- Several ideas, especially feature swapping for augmentation, are similar to Lee et al. (2021d).\n\nSummary Of The Review:\nThe paper proposes an augmentation method to disentangle target object and background-related features, encouraging the localization map to focus on true foregrounds. The work demonstrates an interesting idea with consistent improvements on existing WSSS methods. However, several questions and concerns remain. The reviewer was initially borderline and awaited the rebuttal.\n\nPost Rebuttal/Discussion:\nThe authors’ rebuttal and revision partially addressed key points, including clarification of AFA/ABA and some formulations. However, several issues persist:\n1. Conceptual concern: Since CAM relies on both foreground and background for classification, it is unclear whether CAM remains effective if features are randomized by the proposed augmentation.\n2. Presentation issues: The paper’s clarity still needs significant improvement.\n3. Performance concern: Some results remain weak as pointed out by other reviewers (e.g., Reviewer sGvK).\n\nOverall, due to these unresolved issues, the reviewer lowered the score.\n\nCorrectness: 3: Some of the paper’s claims have minor issues. A few statements are not well-supported, or require small changes to be made correct.\nTechnical Novelty And Significance: 3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.\nEmpirical Novelty And Significance: 3: The contributions are significant and somewhat new. Aspects of the contributions exist in prior work.\nFlag For Ethics Review: NO.\nRecommendation: 5: marginally below the acceptance threshold\nConfidence: 4: You are confident in your assessment, but not absolutely certain. It is unlikely, but not impossible, that you did not understand some parts of the submission or that you are unfamiliar with some pieces of related work.",
    "text_summary": "### Motivation\nWeakly supervised semantic segmentation (WSSS) often relies on localization maps generated by classifiers to create pseudo-masks. However, classifiers trained on biased datasets tend to confuse target objects with their frequently co-occurring backgrounds (e.g., sheep with grass or airplanes with the sky). This reliance on spurious correlations between objects and backgrounds leads to inaccurate localization maps and poor segmentation performance. Traditional data augmentation methods, such as Mixup, CutMix, and saliency-based techniques, fail to effectively disentangle foreground (class-relevant) and background (class-irrelevant) features, further exacerbating the issue. To address these limitations, the study proposes a novel augmentation method, Disentangled Feature Swapping Augmentation (DEFT), which aims to reduce classifier bias by disentangling and augmenting feature representations in the feature space.\n\n### Method\nThe proposed DEFT method operates in the feature space to disentangle foreground and background features and mitigate spurious correlations. The key components of DEFT are:\n\n1. **Feature Disentanglement**:\n   - Input images are passed through a backbone network to extract feature representations.\n   - Separate attention maps for foreground (\\(A_{fg}\\)) and background (\\(A_{bg}\\)) are computed using learnable convolutional kernels. These maps highlight spatial importance for class-relevant and class-irrelevant regions, respectively.\n   - Foreground (\\(z_{fg}\\)) and background (\\(z_{bg}\\)) features are aggregated using the attention maps, ensuring their separation in the representation space.\n   - Two linear classifiers (\\(f_{fg}\\) and \\(f_{bg}\\)) are trained to predict opposite labels for \\(z_{fg}\\) and \\(z_{bg}\\), enforcing disentanglement. A disentanglement loss (\\(L_{disen}\\)) is used to optimize this process.\n\n2. **Feature Swapping**:\n   - Disentangled features are randomly swapped within mini-batches to reduce the classifier's reliance on specific object-background correlations.\n   - Two types of swaps are performed:\n     - **Background Swap**: Background features (\\(z_{bg}\\)) are permuted across samples while keeping foreground features (\\(z_{fg}\\)) fixed.\n     - **Foreground Swap**: Foreground features (\\(z_{fg}\\)) are permuted across samples while keeping background features (\\(z_{bg}\\)) fixed.\n   - A swapping loss (\\(L_{swap}\\)) ensures that the classifier remains invariant to these swaps, learning to focus on intrinsic object features rather than contextual cues.\n\n3. **Pseudo-Mask Generation**:\n   - Class Activation Maps (CAMs) are refined using the disentangled features to generate accurate localization maps. These maps are further processed to create pseudo-masks for training segmentation networks.\n\n4. **Training Strategy**:\n   - Swapping is applied only after a specific training iteration to ensure proper disentanglement of features.\n   - Background features are detached during backpropagation to prevent interference with the disentanglement process.\n\n### Results\nThe effectiveness of DEFT was evaluated on the Pascal VOC 2012 dataset, which includes 21 classes and 10,582 images with class-level labels. The method was tested across multiple WSSS frameworks, including PSA, IRN, AdvCAM, and AMN. Key findings include:\n\n1. **Localization Map and Pseudo-Mask Performance**:\n   - DEFT consistently improved the mean Intersection over Union (mIoU) of localization maps and pseudo-masks across all tested methods:\n     - PSA: Localization mIoU improved from 48.0% to 51.6%.\n     - IRN: Localization mIoU improved from 48.3% to 52.3%.\n     - AMN: Pseudo-mask mIoU improved from 72.2% to 72.8%.\n\n2. **Comparison with Other Augmentation Methods**:\n   - DEFT outperformed traditional augmentation techniques such as Mixup, CutMix, and Context Decoupling Augmentation (CDA). For example, DEFT achieved an mIoU of 52.3%, compared to 49.2% for CutMix and 50.8% for CDA.\n\n3. **Segmentation Results**:\n   - DEFT improved segmentation network performance on the Pascal VOC 2012 validation and test sets:\n     - PSA: Validation mIoU increased by 4.2% (61.7% → 65.9%), and test mIoU by 3.1% (63.7% → 66.8%).\n     - IRN: Validation mIoU increased by 5.6% (63.5% → 69.1%), and test mIoU by 3.9% (64.8% → 68.7%).\n\n4. **Bias Mitigation**:\n   - DEFT reduced the impact of spurious correlations between objects and their co-occurring backgrounds. For example:\n     - Aeroplane-sky mIoU improved from 83.72% (IRN) to 87.34%.\n     - Train-railroad mIoU improved from 68.83% (IRN) to 74.69%.\n\n5. **Ablation Study**:\n   - The study analyzed the contributions of different loss terms:\n     - Adding feature disentanglement loss (\\(L_{disen}\\)) improved mIoU by 1.8%.\n     - Adding two-way swapping loss (\\(L_{swap}\\)) further improved mIoU by 1.4%.\n   - These results highlight the importance of both disentanglement and feature swapping in improving WSSS performance.\n\n6. **Visualization**:\n   - T-SNE visualizations demonstrated that DEFT effectively separates foreground and background features in the representation space, validating its ability to disentangle class-relevant and class-irrelevant features.\n\n### Conclusion\nDEFT addresses a critical limitation in WSSS by disentangling and augmenting feature representations to reduce spurious correlations between objects and backgrounds. Unlike traditional augmentation methods, DEFT operates in the feature space, enabling diverse and unbiased representation learning without manual intervention. The method consistently improves localization map quality, pseudo-mask accuracy, and segmentation performance across multiple WSSS frameworks. Future work will explore metric learning to further enhance feature disentanglement and investigate the application of DEFT to other weakly supervised learning tasks.",
    "text_only_review": "#### 1. Summary\nThis paper introduces Disentangled Feature Swapping Augmentation (DEFT), a novel data augmentation method for weakly supervised semantic segmentation (WSSS). DEFT addresses the issue of spurious correlations between target objects and co-occurring backgrounds in classifier-generated localization maps. The method disentangles foreground and background features in the feature space and performs feature swapping to reduce classifier bias. DEFT is evaluated on the Pascal VOC 2012 dataset across multiple WSSS frameworks, showing consistent improvements in localization map quality, pseudo-mask accuracy, and segmentation performance. The paper also includes ablation studies and visualizations to validate the effectiveness of the proposed method.\n\n#### 2. Strengths\n- **Clear Motivation**: The paper identifies a critical problem in WSSS—spurious correlations between objects and backgrounds—and provides a compelling motivation for addressing it.\n- **Innovative Methodology**: DEFT introduces a novel approach to disentangle foreground and background features and reduce classifier bias through feature swapping. This is a significant departure from traditional augmentation methods.\n- **Comprehensive Evaluation**: The method is evaluated across multiple WSSS frameworks, demonstrating its generalizability and effectiveness. Improvements in mIoU for localization maps, pseudo-masks, and segmentation results are well-documented.\n- **Quantitative and Qualitative Analysis**: The paper includes extensive quantitative results, ablation studies, and T-SNE visualizations, providing strong evidence for the effectiveness of DEFT.\n- **Bias Mitigation**: The method explicitly addresses and reduces spurious correlations, a critical issue in WSSS, as evidenced by improved mIoU for challenging object-background pairs (e.g., aeroplane-sky, train-railroad).\n\n#### 3. Weaknesses\n- **Limited Dataset Scope**: The evaluation is restricted to the Pascal VOC 2012 dataset. While this dataset is widely used, additional experiments on more diverse datasets (e.g., COCO, ADE20K) would strengthen the claims of generalizability.\n- **Complexity of Implementation**: The proposed method involves multiple components (e.g., feature disentanglement, swapping, loss terms), which may pose implementation challenges for practitioners. A more detailed discussion on computational overhead and scalability would be beneficial.\n- **Limited Comparison with State-of-the-Art**: While DEFT is compared to traditional augmentation methods (e.g., Mixup, CutMix), the comparison with other advanced WSSS methods is limited. Including more baselines would provide a clearer picture of DEFT's relative performance.\n- **Potential Overfitting to Pascal VOC**: The method's reliance on specific loss terms and feature disentanglement mechanisms may lead to overfitting to the characteristics of Pascal VOC. Generalization to other datasets and tasks remains uncertain.\n\n#### 4. Clarity & Reproducibility\n- **Clarity**: The paper is well-written and clearly explains the motivation, methodology, and results. The use of mathematical formulations and visualizations aids understanding.\n- **Reproducibility**: While the methodology is described in detail, the paper does not provide sufficient implementation details, such as hyperparameters, training schedules, or pseudo-code. Releasing the code and pre-trained models would significantly enhance reproducibility.\n- **Experimental Design**: The experiments are well-structured, and the results are presented in a clear and interpretable manner. However, the lack of details on computational resources and runtime limits the assessment of practical feasibility.\n\n#### 5. Novelty & Significance\n- **Novelty**: DEFT introduces a unique approach to disentangle and augment feature representations in the feature space, which is a novel contribution to WSSS. The use of feature swapping to mitigate spurious correlations is particularly innovative.\n- **Significance**: The method addresses a critical limitation in WSSS and shows consistent improvements across multiple frameworks. This has the potential to influence future research in WSSS and related areas.\n- **Broader Impact**: The proposed method could be extended to other weakly supervised learning tasks, such as object detection or instance segmentation, broadening its applicability.\n\n#### Overall Assessment\nThe paper presents a novel and well-motivated method for improving WSSS by addressing spurious correlations between objects and backgrounds. The proposed DEFT method is innovative and demonstrates strong performance improvements on the Pascal VOC 2012 dataset. However, the limited dataset scope, lack of comparison with additional state-of-the-art methods, and insufficient implementation details slightly detract from its overall impact. Addressing these limitations in future work would further strengthen the paper's contributions.",
    "merged_image_path": "temp_cache\\6502_disentangled_feature_swapping__merged.png",
    "image_only_review": "#### 1. Summary\nThe paper presents a novel approach called Disentangled Feature Swapping Augmentation (DFSA) for weakly supervised semantic segmentation (WSSS). The method aims to improve the performance of WSSS models by disentangling and swapping foreground and background features in images. By doing so, the model can better learn to distinguish between objects and their surroundings, which is a common challenge in WSSS due to the lack of detailed annotations. The authors propose a framework that leverages this feature swapping to enhance the classifier's ability to focus on relevant parts of the image, ultimately improving segmentation accuracy. The paper includes a comprehensive set of experiments demonstrating the effectiveness of DFSA on standard benchmarks.\n\n#### 2. Strengths\n- **Innovative Approach**: The paper introduces a creative method for augmenting data in WSSS by disentangling and swapping features, which is a novel contribution to the field.\n- **Comprehensive Evaluation**: The authors provide extensive experimental results on multiple datasets, showing significant improvements over existing methods.\n- **Clear Motivation**: The paper clearly articulates the challenges in WSSS and how the proposed method addresses these issues.\n- **Theoretical Justification**: The approach is supported by a solid theoretical foundation, explaining why feature disentanglement and swapping can lead to better segmentation performance.\n\n#### 3. Weaknesses\n- **Complexity**: The proposed method adds complexity to the training process, which might be a barrier to adoption in practical applications.\n- **Limited Discussion on Limitations**: The paper does not thoroughly discuss the potential limitations or failure cases of the proposed method.\n- **Generalization**: While the method shows improvements on benchmark datasets, it is unclear how well it generalizes to other types of images or domains not covered in the experiments.\n\n#### 4. Clarity & Reproducibility\n- **Clarity**: The paper is well-written and structured, with a logical flow from the introduction to the conclusion. The methodology is explained in detail, making it accessible to readers with a background in machine learning and computer vision.\n- **Reproducibility**: The authors provide sufficient details about the experimental setup, including hyperparameters and datasets used. However, the paper would benefit from the inclusion of code or pseudocode to facilitate easier replication of results by other researchers.\n\n#### 5. Novelty & Significance\n- **Novelty**: The concept of feature disentanglement and swapping for data augmentation in WSSS is novel and represents a meaningful contribution to the field. This approach has not been explored extensively in the literature, setting this work apart from existing methods.\n- **Significance**: The proposed method has the potential to significantly impact the field of WSSS by providing a new way to enhance model performance without requiring additional labeled data. The improvements demonstrated in the experiments suggest that this approach could be a valuable addition to the toolkit of researchers and practitioners working on semantic segmentation.",
    "multimodal_review": "**1. Summary**  \nThe paper introduces a novel augmentation method, Disentangled Feature Swapping Augmentation (DEFT), aimed at improving weakly supervised semantic segmentation (WSSS) by addressing classifier biases due to spurious correlations between objects and backgrounds. DEFT operates in the feature space to disentangle foreground and background features, employing feature swapping to mitigate these biases. The method demonstrates significant improvements in localization map quality, pseudo-mask accuracy, and segmentation performance across multiple WSSS frameworks on the Pascal VOC 2012 dataset. DEFT outperforms traditional augmentation techniques and effectively reduces the impact of spurious correlations.\n\n**2. Strengths**  \n- The paper addresses a critical issue in WSSS by focusing on disentangling and augmenting feature representations to reduce classifier bias.\n- DEFT demonstrates robust improvements in segmentation performance across various frameworks, showcasing its versatility and effectiveness.\n- The method is well-validated with comprehensive experiments, including comparisons with existing techniques and detailed ablation studies.\n- The paper provides clear visualizations, such as T-SNE plots, that effectively illustrate the disentanglement of foreground and background features.\n\n**3. Weaknesses**  \n- **Theory and Justification**: The theoretical underpinning of the disentanglement process could be further elaborated. Section 3.1 would benefit from a more detailed explanation of how the disentanglement loss \\(L_{disen}\\) specifically contributes to the separation of features. Suggestion: Include a theoretical analysis or additional references to support the disentanglement approach.\n- **Baseline Comparison**: While DEFT is compared against several augmentation methods, the paper lacks a direct comparison with recent state-of-the-art WSSS methods that do not rely on augmentation. Suggestion: Include a comparison with non-augmentation-based WSSS methods in Table 2 to provide a broader context of DEFT's performance.\n- **Clarity in Method Description**: The description of the feature swapping mechanism in Section 3.2 could be more precise. The process of how swaps are executed and their impact on the learning process is not entirely clear. Suggestion: Provide a step-by-step explanation or algorithmic pseudocode for the swapping process.\n- **Figure Clarity**: Figure 2, which illustrates the DEFT method, lacks detailed annotations and explanations of each component. Suggestion: Enhance the figure with clearer labels and a more descriptive caption to improve understanding.\n- **Reproducibility Details**: The paper does not specify certain experimental details such as the choice of hyperparameters, random seeds, or hardware used for training. Suggestion: Include a dedicated section detailing these aspects to facilitate reproducibility.\n\n**4. Clarity & Reproducibility**  \n  **(a) Textual Clarity**: The paper is generally well-written, with logical flow and clear articulation of ideas. However, some sections, particularly those describing the methodology, could benefit from more detailed explanations and theoretical justifications. The assumptions and limitations of the approach are not explicitly discussed, which could aid in understanding the scope of the method's applicability.\n  \n  **(b) Figure & Caption Clarity**: Figures are generally informative, but some, like Figure 2, require more detailed annotations and clearer captions to effectively convey the methodology. Axes and labels are consistent, but additional context in captions would enhance comprehension.\n  \n  **(c) Reproducibility Transparency**: The experimental setup is described, but lacks specific details on hyperparameters, hardware, and random seeds, which are crucial for reproducibility. While the paper mentions datasets used, it does not discuss code availability or provide algorithmic steps in detail, which would be beneficial for replication.\n\n**5. Novelty & Significance**  \nThe paper presents a novel approach to addressing a well-known problem in WSSS by disentangling and augmenting feature representations to reduce spurious correlations. This method is well-motivated and contextualized within the literature, offering a significant contribution by improving segmentation performance across multiple frameworks. The empirical results substantiate the claims, demonstrating the method's effectiveness and potential impact on the field. While the novelty lies in the feature space operation and swapping mechanism, further theoretical exploration could enhance the understanding and applicability of the approach. Overall, DEFT provides valuable insights and advancements in the domain of weakly supervised learning.",
    "multimodal_rag_review": "**1. Summary**  \nThe paper introduces Disentangled Feature Swapping Augmentation (DEFT), a novel approach for improving weakly supervised semantic segmentation (WSSS) by addressing the common issue of object-background entanglement in Class Activation Maps (CAMs). DEFT disentangles foreground and background features and employs feature swapping within mini-batches to reduce dataset biases, enhancing the quality of localization maps and pseudo-masks. The method integrates seamlessly into existing WSSS pipelines and demonstrates significant improvements in segmentation performance across various benchmarks, outperforming traditional augmentation methods.\n\n**2. Strengths**  \n- The paper presents a novel approach that effectively disentangles and swaps features, addressing a critical issue in WSSS.\n- DEFT is designed to be easily integrated into existing pipelines without requiring heuristic decisions or network re-training.\n- The experimental results show substantial improvements in segmentation performance, demonstrating the method's practical efficacy.\n- The paper includes a comprehensive ablation study that highlights the contributions of different components of the proposed method.\n\n**3. Weaknesses**  \n- **Clarity in Methodology**: The explanation of the disentanglement process and the role of the classifiers in Section 3.2 could be clearer. The paper should provide a more detailed description of how the classifiers are trained and how the disentanglement loss is applied. Suggestion: Include a step-by-step explanation or a flowchart to clarify the disentanglement process.\n- **Theoretical Justification**: The paper lacks a strong theoretical foundation to support the empirical results. For instance, the rationale behind the choice of the disentanglement loss function and the swapping strategy in Section 3.2 is not thoroughly justified. Suggestion: Provide theoretical insights or references to support the chosen methodologies.\n- **Baseline Comparisons**: While the paper compares DEFT with several existing methods, it does not explore its applicability to more recent architectures or datasets beyond Pascal VOC 2012. Suggestion: Include experiments on additional datasets or with newer architectures to demonstrate the generalizability of DEFT.\n- **Figure Clarity**: Some figures, such as Figure 2, lack detailed captions that explain the components and flow of the DEFT method. Suggestion: Enhance figure captions to be more descriptive and ensure they are self-explanatory.\n- **Reproducibility Details**: The paper does not provide sufficient details about the experimental setup, such as specific hyperparameters, hardware used, or random seeds, which are crucial for reproducibility. Suggestion: Include a dedicated section detailing these aspects to facilitate replication of the results.\n\n**4. Clarity & Reproducibility**  \n  **(a) Textual Clarity** – The paper is generally well-organized, with clear section titles and logical flow. However, some methodological descriptions, particularly in the disentanglement and feature swapping sections, could benefit from additional clarity and detail. Mathematical notations are well-defined, but assumptions and limitations are not explicitly discussed.\n  \n  **(b) Figure & Caption Clarity** – Figures are relevant and support the paper's claims, but some captions lack sufficient detail. For example, Figure 2 could be improved with a more comprehensive explanation of the depicted process. Axes and labels are consistent, but the correlation between diagrams and textual descriptions could be enhanced.\n  \n  **(c) Reproducibility Transparency** – The paper provides a general overview of the experimental setup but lacks specific details necessary for reproducibility, such as hyperparameters, hardware specifications, and random seeds. The inclusion of these details, along with a mention of code/data availability, would significantly enhance reproducibility.\n\n**5. Novelty & Significance**  \nDEFT introduces a novel approach to feature disentanglement and augmentation in the context of WSSS, addressing a significant challenge in the field. The method is well-motivated and contextualized within the existing literature, offering a practical solution that improves segmentation performance without requiring additional supervision or complex modifications to existing models. The empirical results substantiate the claims, demonstrating the method's effectiveness and potential impact on the community. However, the paper would benefit from stronger theoretical grounding and broader experimental validation to fully establish its significance and applicability."
}